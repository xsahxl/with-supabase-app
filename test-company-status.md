# 公司状态管理功能测试指南

## 功能概述
已成功为公司管理系统添加了状态管理功能，包括：
- 草稿保存
- 提交审核
- 审核通过/不通过
- 下架功能

## 数据库变更
- 添加了 `status` 字段（草稿/待审核/审核通过/审核不通过/已下架）
- 添加了 `status_updated_at` 字段记录状态变更时间
- 创建了状态约束和索引

## 前端功能

### 1. 创建公司页面 (`/companies/create`)
- **保存草稿按钮**: 将公司状态设置为"草稿"
- **提交审核按钮**: 将公司状态设置为"待审核"
- 表单验证：提交审核时需要填写必填字段

### 2. 编辑公司页面 (`/companies/[id]/edit`)
- 支持草稿保存和提交审核
- 根据当前状态显示相应的操作按钮

### 3. 公司详情页面 (`/companies/[id]`)
- 显示当前状态徽章
- 状态管理面板，包含状态变更按钮：
  - 草稿 → 提交审核
  - 待审核 → 审核通过/审核不通过
  - 审核通过 → 下架
  - 审核不通过/已下架 → 重新编辑

### 4. 公司列表页面 (`/companies`)
- 显示每个公司的状态徽章
- 状态过滤功能：可按状态筛选公司
- 搜索和状态过滤组合使用

## 状态流转
```
草稿 → 待审核 → 审核通过 → 已下架
  ↓         ↓
重新编辑   审核不通过 → 草稿
```

## 测试步骤

### 1. 创建公司测试
1. 访问 `/companies/create`
2. 填写部分信息，点击"保存草稿"
3. 验证状态为"草稿"
4. 完善信息后，点击"提交审核"
5. 验证状态为"待审核"

### 2. 状态管理测试
1. 访问公司详情页面
2. 测试不同状态下的操作按钮
3. 验证状态变更功能

### 3. 列表过滤测试
1. 访问公司列表页面
2. 测试状态过滤功能
3. 测试搜索和过滤组合使用

## 技术实现

### 数据库迁移
- `20241221000000_add_status_to_companies.sql`

### 前端组件
- `StatusBadge`: 状态徽章组件
- 更新的 `CompanyForm`: 支持草稿保存和提交审核
- 更新的 `CompanyCard`: 显示状态信息
- 更新的页面组件：支持状态管理

### 服务函数
- `updateCompanyStatus`: 更新公司状态
- 更新的 `getCompanies`: 支持状态过滤
- 更新的 `createCompany`: 默认创建草稿状态

## 状态颜色映射
- 草稿: 灰色
- 待审核: 黄色
- 审核通过: 绿色
- 审核不通过: 红色
- 已下架: 灰色（较浅） 